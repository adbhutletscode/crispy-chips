<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Crispy Chips{% endblock %}</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chatbot.css') }}">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
</head>
<body>
    <header>
        <!-- Top Bar -->
        <div class="top-bar py-2 bg-warning text-dark">
            <div class="container">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="d-none d-md-flex">
                        <div class="me-4"><i class="fas fa-truck me-2"></i> Free shipping on orders over $50</div>
                        <div><i class="fas fa-phone-alt me-2"></i> Call us: (555) 123-4567</div>
                    </div>
                    <div class="d-flex align-items-center">
                        <div class="social-icons me-3">
                            <a href="#" class="text-dark me-2"><i class="fab fa-facebook-f"></i></a>
                            <a href="#" class="text-dark me-2"><i class="fab fa-instagram"></i></a>
                            <a href="#" class="text-dark"><i class="fab fa-twitter"></i></a>
                        </div>
                        {% if session.admin_logged_in %}
                        <div class="admin-badge">
                            <i class="fas fa-user-shield me-1"></i> Admin Mode
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Navigation -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
            <div class="container">
                <a class="navbar-brand fancy-brand d-flex align-items-center" href="{{ url_for('index') }}">
                    <div class="brand-icon me-2">
                        <i class="fas fa-cookie-bite"></i>
                    </div>
                    <div class="brand-text">
                        <span class="brand-name">Crispy</span>
                        <span class="brand-subtitle">CHIPS</span>
                    </div>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav mx-auto">
                        <li class="nav-item">
                            <a class="nav-link nav-fancy" href="{{ url_for('index') }}">
                                <span>Home</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link nav-fancy" href="#products">
                                <span>Shop</span>
                            </a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle nav-fancy" href="#" id="categoriesDropdown" role="button" data-bs-toggle="dropdown">
                                <span>Categories</span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-dark animate__animated animate__fadeIn">
                                <li><a class="dropdown-item" href="{{ url_for('index') }}?category=Regular">Regular</a></li>
                                <li><a class="dropdown-item" href="{{ url_for('index') }}?category=Flavored">Flavored</a></li>
                                <li><a class="dropdown-item" href="{{ url_for('index') }}?category=Spicy">Spicy</a></li>
                                <li><a class="dropdown-item" href="{{ url_for('index') }}?category=Organic">Organic</a></li>
                            </ul>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link nav-fancy" href="{{ url_for('about') }}">
                                <span>About Us</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link nav-fancy" href="{{ url_for('contact') }}">
                                <span>Contact</span>
                            </a>
                        </li>
                    </ul>
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link position-relative cart-icon" href="{{ url_for('view_cart') }}">
                                <i class="fas fa-shopping-cart"></i>
                                {% if session.cart %}
                                <span class="cart-count">
                                    {{ session.cart.values()|sum }}
                                </span>
                                {% endif %}
                            </a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="adminDropdown" role="button" data-bs-toggle="dropdown">
                                <i class="fas fa-user-cog"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-end animate__animated animate__fadeIn">
                                {% if session.admin_logged_in %}
                                <li class="dropdown-header">Admin Panel</li>
                                <li><a class="dropdown-item" href="{{ url_for('admin_index') }}"><i class="fas fa-tachometer-alt me-2"></i>Dashboard</a></li>
                                <li><a class="dropdown-item" href="{{ url_for('add_product') }}"><i class="fas fa-plus me-2"></i>Add Product</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{{ url_for('admin_logout') }}"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                                {% else %}
                                <li><a class="dropdown-item" href="{{ url_for('admin_login') }}"><i class="fas fa-sign-in-alt me-2"></i>Admin Login</a></li>
                                {% endif %}
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <!-- Toast Notifications Container -->
    <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1100;">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                <div class="toast fancy-toast toast-{{ category }} show animate__animated animate__fadeInRight" role="alert" aria-live="assertive" aria-atomic="true">
                    <div class="toast-header">
                        <div class="toast-icon me-2">
                            {% if category == 'success' %}
                            <i class="fas fa-check-circle"></i>
                            {% elif category == 'error' or category == 'danger' %}
                            <i class="fas fa-exclamation-circle"></i>
                            {% elif category == 'warning' %}
                            <i class="fas fa-exclamation-triangle"></i>
                            {% else %}
                            <i class="fas fa-info-circle"></i>
                            {% endif %}
                        </div>
                        <strong class="me-auto">
                            {% if category == 'success' %}
                            Success!
                            {% elif category == 'error' or category == 'danger' %}
                            Error!
                            {% elif category == 'warning' %}
                            Warning!
                            {% else %}
                            Information
                            {% endif %}
                        </strong>
                        <small>Just now</small>
                        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                    </div>
                    <div class="toast-body">
                        {{ message }}
                    </div>
                </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
    </div>

    <main class="container my-4">
        {% block content %}{% endblock %}
    </main>

    <footer class="bg-dark text-white py-5 mt-5">
        <div class="container">
            <div class="row g-4">
                <div class="col-lg-4 col-md-6">
                    <div class="mb-4">
                        <a href="{{ url_for('index') }}" class="d-flex align-items-center text-decoration-none mb-3">
                            <i class="fas fa-cookie-bite fa-2x me-2 text-warning"></i>
                            <h4 class="text-white m-0">Crispy Chips</h4>
                        </a>
                        <p class="mb-4">Artisanal potato chips crafted with care. Experience the perfect crunch with every bite.</p>
                        <div class="d-flex gap-3">
                            <a href="#" class="text-white social-icon"><i class="fab fa-facebook-f"></i></a>
                            <a href="#" class="text-white social-icon"><i class="fab fa-twitter"></i></a>
                            <a href="#" class="text-white social-icon"><i class="fab fa-instagram"></i></a>
                            <a href="#" class="text-white social-icon"><i class="fab fa-pinterest"></i></a>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2 col-md-6">
                    <h5 class="mb-4 text-warning">Quick Links</h5>
                    <ul class="list-unstyled footer-links">
                        <li class="mb-2"><a href="{{ url_for('index') }}" class="text-white text-decoration-none"><i class="fas fa-chevron-right me-2 small text-warning"></i>Home</a></li>
                        <li class="mb-2"><a href="#products" class="text-white text-decoration-none"><i class="fas fa-chevron-right me-2 small text-warning"></i>Shop</a></li>
                        <li class="mb-2"><a href="{{ url_for('about') }}" class="text-white text-decoration-none"><i class="fas fa-chevron-right me-2 small text-warning"></i>About Us</a></li>
                        <li class="mb-2"><a href="{{ url_for('contact') }}" class="text-white text-decoration-none"><i class="fas fa-chevron-right me-2 small text-warning"></i>Contact</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h5 class="mb-4 text-warning">Categories</h5>
                    <ul class="list-unstyled footer-links">
                        <li class="mb-2"><a href="{{ url_for('index') }}?category=Regular" class="text-white text-decoration-none"><i class="fas fa-chevron-right me-2 small text-warning"></i>Regular Chips</a></li>
                        <li class="mb-2"><a href="{{ url_for('index') }}?category=Flavored" class="text-white text-decoration-none"><i class="fas fa-chevron-right me-2 small text-warning"></i>Flavored Chips</a></li>
                        <li class="mb-2"><a href="{{ url_for('index') }}?category=Spicy" class="text-white text-decoration-none"><i class="fas fa-chevron-right me-2 small text-warning"></i>Spicy Chips</a></li>
                        <li class="mb-2"><a href="{{ url_for('index') }}?category=Organic" class="text-white text-decoration-none"><i class="fas fa-chevron-right me-2 small text-warning"></i>Organic Chips</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h5 class="mb-4 text-warning">Contact Us</h5>
                    <ul class="list-unstyled contact-info">
                        <li class="d-flex mb-3">
                            <i class="fas fa-map-marker-alt me-3 mt-1 text-warning"></i>
                            <span>123 Crispy Lane, Chiptown, CT 12345</span>
                        </li>
                        <li class="d-flex mb-3">
                            <i class="fas fa-phone-alt me-3 mt-1 text-warning"></i>
                            <span>(555) 123-4567</span>
                        </li>
                        <li class="d-flex mb-3">
                            <i class="fas fa-envelope me-3 mt-1 text-warning"></i>
                            <span>info@crispychips.com</span>
                        </li>
                        <li class="d-flex">
                            <i class="fas fa-clock me-3 mt-1 text-warning"></i>
                            <span>Mon-Fri: 9AM - 5PM</span>
                        </li>
                    </ul>
                </div>
            </div>
            <hr class="my-4 bg-secondary">
            <div class="row align-items-center">
                <div class="col-md-6 text-center text-md-start">
                    <p class="mb-md-0">&copy; 2023 Crispy Chips. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <ul class="list-inline mb-0">
                        <li class="list-inline-item"><a href="#" class="text-white text-decoration-none small">Privacy Policy</a></li>
                        <li class="list-inline-item"><span class="text-muted mx-2">|</span></li>
                        <li class="list-inline-item"><a href="#" class="text-white text-decoration-none small">Terms of Use</a></li>
                        <li class="list-inline-item"><span class="text-muted mx-2">|</span></li>
                        <li class="list-inline-item"><a href="#" class="text-white text-decoration-none small">FAQ</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <a href="#" class="btn btn-warning btn-lg back-to-top" role="button">
        <i class="fas fa-arrow-up"></i>
    </a>

    <!-- Chatbot -->
    <div class="chatbot-container">
        <div class="chatbot-toggle">
            <i class="fas fa-comment"></i>
            <i class="fas fa-times"></i>
            <div class="chatbot-notification">1</div>
        </div>
        <div class="chatbot-window">
            <div class="chatbot-header">
                <div class="chatbot-header-title">
                    <i class="fas fa-robot"></i>
                    <h3>Crispy Assistant</h3>
                    <span class="status"></span>
                </div>
                <div class="chatbot-header-actions">
                    <button id="chatbot-minimize"><i class="fas fa-minus"></i></button>
                </div>
            </div>
            <div class="chatbot-body">
                <!-- Messages will be added here dynamically -->
            </div>
            <div class="chatbot-footer">
                <div class="chatbot-input-container">
                    <input type="text" class="chatbot-input" placeholder="Type your message...">
                    <button class="chatbot-send" disabled>
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <!-- Chatbot JS -->
    <script src="{{ url_for('static', filename='js/chatbot.js') }}"></script>

    <script>
        // Initialize all toasts
        document.addEventListener('DOMContentLoaded', function() {
            // Back to top button
            var backToTopBtn = document.querySelector('.back-to-top');

            // Initially hide the button
            if (backToTopBtn) {
                backToTopBtn.style.display = 'none';

                window.addEventListener('scroll', function() {
                    if (window.pageYOffset > 300) {
                        backToTopBtn.style.display = 'block';
                    } else {
                        backToTopBtn.style.display = 'none';
                    }
                });

                backToTopBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    window.scrollTo({top: 0, behavior: 'smooth'});
                });
            }

            // Initialize toasts
            var toastElList = [].slice.call(document.querySelectorAll('.toast'));
            var toastList = toastElList.map(function(toastEl) {
                var toast = new bootstrap.Toast(toastEl, {
                    autohide: true,
                    delay: 5000
                });
                return toast;
            });

            // Auto-dismiss toasts after 5 seconds
            setTimeout(function() {
                document.querySelectorAll('.toast').forEach(function(toast) {
                    toast.classList.add('animate__fadeOutRight');
                    setTimeout(function() {
                        toast.remove();
                    }, 1000);
                });
            }, 5000);

            // Add hover effect to navbar items
            var navItems = document.querySelectorAll('.nav-fancy');
            navItems.forEach(function(item) {
                item.addEventListener('mouseenter', function() {
                    this.classList.add('animate__animated', 'animate__pulse');
                });
                item.addEventListener('animationend', function() {
                    this.classList.remove('animate__animated', 'animate__pulse');
                });
            });
        });
    </script>

    {% block scripts %}{% endblock %}
</body>
</html>